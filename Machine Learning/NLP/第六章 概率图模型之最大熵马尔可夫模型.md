# 最大熵马尔可夫模型

最大熵马尔可夫模型是判别式模型，与隐马尔科夫模型对联合概率建模不同，最大熵马尔可夫模型直接对条件概率建模，即，直接求给定观测序列条件下得到状态序列的概率。它去除了隐马尔科夫模型中的观测独立性假设，引入了特征函数：

![image](D:/Program/YNote/workspace/gorpel@163.com/Picture/memm1.png)

而每一时刻的条件概率由最大熵模型确定：

![image](D:/Program/YNote/workspace/gorpel@163.com/Picture/memm2.png)


这里的分母**Z**是归一化银子，但要注意的是它是对位置i的局部归一化。

**fa**是特征函数，与最大熵和条件随机场里的特征函数意义相同，**λ**是权重

在最大熵马尔可夫模型中，当前时刻的状态由前一时刻的状态和观测序列决定(对观测序列使用特征函数，相当于使用了整个观测序列)，
这也是生成式模型和判别式模型的区别，生成式模型嘉定状态序列决定观测序列，而判别式模型正相反，假设观测序列决定状态序列。

![image](D:/Program/YNote/workspace/gorpel@163.com/Picture/对比.png)

从上图可以看出隐马尔科夫和最大熵马尔可夫的区别。

还要注意的是，最大熵马尔可夫中，最终的条件概率是由每一个节点由前向后推算出来的，是每一个节点条件概率的连乘，而在条件随机场中，是对整个序列的条件概率直接建模。也正是由于这一点，最大熵马尔可夫模型的解码(预测)问题需要使用到维特比算法。

## 学习

极大似然估计， 梯度下降，拟牛顿法等

与HMM和CRF相比，MEMM的参数训练非常快。

## 预测

与HMM类似，使用维特比算法